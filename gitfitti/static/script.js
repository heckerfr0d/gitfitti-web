var txt = {
    'A': [
        "    ",
        " aa ",
        "a  a",
        "aaaa",
        "a  a",
        "a  a",
        "    "
    ],
    'B': [
        "    ",
        "bbb ",
        "b  b",
        "bbbb",
        "b  b",
        "bbb ",
        "    "
    ],
    'C': [
        "    ",
        " cc ",
        "c  c",
        "c   ",
        "c  c",
        " cc ",
        "    ",
    ],
    'D': [
        "    ",
        "ddd ",
        "d  d",
        "d  d",
        "d  d",
        "ddd ",
        "    ",
    ],
    'E': [
        "   ",
        "eee",
        "e  ",
        "eee",
        "e  ",
        "eee",
        "   ",
    ],
    'F': [
        "   ",
        "fff",
        "f  ",
        "fff",
        "f  ",
        "f  ",
        "   ",
    ],
    'G': [
        "    ",
        " ggg",
        "g   ",
        "g gg",
        "g  g",
        " gg ",
        "    ",
    ],
    'H': [
        "    ",
        "h  h",
        "h  h",
        "hhhh",
        "h  h",
        "h  h",
        "    "
    ],
    'I': [
        " ",
        "i",
        "i",
        "i",
        "i",
        "i",
        " ",
    ],
    'J': [
        "    ",
        "   j",
        "   j",
        "   j",
        "j  j",
        " jj ",
        "    ",
    ],
    'K': [
        "    ",
        "k  k",
        "k k ",
        "kk  ",
        "k k ",
        "k  k",
        "    ",
    ],
    'L': [
        "   ",
        "l  ",
        "l  ",
        "l  ",
        "l  ",
        "lll",
        "   ",
    ],
    'M': [
        "     ",
        "m   m",
        "mm mm",
        "m m m",
        "m   m",
        "m   m",
        "     ",
    ],
    'N': [
        "     ",
        "n   n",
        "nn  n",
        "n n n",
        "n  nn",
        "n   n",
        "     ",
    ],
    'O': [
        "    ",
        " oo ",
        "o  o",
        "o  o",
        "o  o",
        " oo ",
        "    ",
    ],
    'P': [
        "    ",
        "ppp ",
        "p  p",
        "ppp ",
        "p   ",
        "p   ",
        "    ",
    ],
    'Q': [
        "    ",
        " qq ",
        "q  q",
        "q  q",
        "q  q",
        " qq ",
        "   q"
    ],
    'R': [
        "    ",
        "rrr ",
        "r  r",
        "rrr ",
        "r r ",
        "r  r",
        "    ",
    ],
    'S': [
        "    ",
        " sss",
        "s   ",
        " ss ",
        "   s",
        "sss ",
        "    ",
    ],
    'T': [
        "   ",
        "ttt",
        " t ",
        " t ",
        " t ",
        " t ",
        "   ",
    ],
    'U': [
        "    ",
        "u  u",
        "u  u",
        "u  u",
        "u  u",
        " uu ",
        "    ",
    ],
    'V': [
        "     ",
        "v   v",
        "v   v",
        " v v ",
        " v v ",
        "  v  ",
        "     ",
    ],
    'W': [
        "     ",
        "w   w",
        "w w w",
        "w w w",
        "w w w",
        " w w ",
        "     ",
    ],
    'X': [
        "     ",
        "x   x",
        " x x ",
        "  x  ",
        " x x ",
        "x   x",
        "     ",
    ],
    'Y': [
        "     ",
        "y   y",
        " y y ",
        "  y  ",
        "  y  ",
        "  y  ",
        "     ",
    ],
    'Z': [
        "   ",
        "zzz",
        "  z",
        " z ",
        "z  ",
        "zzz",
        "   ",
    ],
    '.': [
        " ",
        " ",
        " ",
        " ",
        " ",
        ".",
        " ",
    ],
    ',': [
        "  ",
        "  ",
        "  ",
        "  ",
        "  ",
        " ,",
        ", ",
    ],
    ';': [
        "  ",
        "  ",
        " ;",
        "  ",
        " ;",
        "; ",
        "  ",
    ],
    ':': [
        " ",
        " ",
        ":",
        " ",
        ":",
        " ",
        " ",
    ],
    '\'': [],
    '"': [
        " ",
        "'",
        "'",
        " ",
        " ",
        " ",
        " ",
    ],
    ' ': [
        " ",
        " ",
        " ",
        " ",
        " ",
        " ",
        " ",
    ],
    '+': [
        "   ",
        "   ",
        " + ",
        "+++",
        " + ",
        "   ",
        "   ",
    ],
    '-': [
        "  ",
        "  ",
        "  ",
        "--",
        "  ",
        "  ",
        "  ",
    ],
    '_': [
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "___",
        "   ",
    ],
    '[': [
        "  ",
        "[[",
        "[ ",
        "[ ",
        "[ ",
        "[[",
        "  ",
    ],
    ']': [
        "  ",
        "]]",
        " ]",
        " ]",
        " ]",
        "]]",
        "  ",
    ],
    '(': [
        "  ",
        " (",
        "( ",
        "( ",
        "( ",
        " (",
        "  ",
    ],
    ')': [
        "  ",
        ") ",
        " )",
        " )",
        " )",
        ") ",
        "  ",
    ],
    '<': [
        "   ",
        "  <",
        " < ",
        "<  ",
        " < ",
        "  <",
        "   ",
    ],
    '>': [
        "   ",
        ">  ",
        " > ",
        "  >",
        " > ",
        ">  ",
        "   ",
    ],
    '!': [
        " ",
        "!",
        "!",
        "!",
        " ",
        "!",
        " ",
    ],
    '?': [
        "    ",
        "??? ",
        "   ?",
        " ?? ",
        "    ",
        " ?  ",
        "    ",
    ],
    '*': [
        "     ",
        "  *  ",
        "* * *",
        " *** ",
        "* * *",
        "  *  ",
        "     ",
    ]
};

var pub = Array();

function toggle(elem) {
    var radios = elem.parentNode.querySelector('input[type="radio"]');
    if(!radios) console.log(elem);
    var checked = elem.parentNode.querySelector('input[type="radio"]:checked');
    if(!checked) console.log(elem);
    var colorClasses = ["c0", "c1", "c2"];
    var next = checked.nextElementSibling;
    if (!next) {
        next = radios;
    }
    checked.checked = false;
    next.checked = true;
    var newValue = next.value;
    elem.classList.remove(colorClasses[0]);
    elem.classList.remove(colorClasses[1]);
    elem.classList.remove(colorClasses[2]);
    elem.classList.add(colorClasses[newValue]);
    console.log(colorClasses[newValue]);
}

function findw(text) {
    var w = 0;
    for (var c in text) {
        if (text[c] in txt)
            w += txt[text[c]][0].length + 1;
        else if (text[c].toUpperCase() in txt)
            w += txt[text[c].toUpperCase()][0].length + 1;
    }
    return w - 1;
}

function render(trans, text) {
    var w = findw(text);
    if (w > 52)
        alert("You typed too long");
    else {
        var offset = (((52 - w) / 2) >> 0);
        for (var c in text) {
            if (!(text[c] in txt) && text[c].toUpperCase() in txt)
                text = text.replaceAll(text[c], text[c].toUpperCase());
            if (text[c] in txt) {
                for (var k = 0; k < 7; k++)
                    for (var j = offset; j < offset + (txt[text[c]][0].length); j++)
                        if (txt[text[c]][k][j - offset] != ' ')
                            toggle(trans.parentNode.querySelector('button[name="' + String(k) + ' ' + String(j) + '"]'));
                offset += txt[text[c]][0].length;
                if (c != ' ')
                    offset++;
            }
        }
    }
}

const translate = document.querySelectorAll('input[name="translate"]');

translate.forEach(trans => {
    trans.addEventListener('click', () => {
        var text = trans.parentNode.querySelector('input[name="ttg"]').value;
        for (var i in pub) {
            if (text.includes(pub[i])) {
                txt['~'] = txt[pub[i]];
                text = text.replaceAll(pub[i], '~');
            }
        }
        render(trans, text);
    });
});

const clear = document.querySelectorAll('input[name="clear"]');

clear.forEach(clr => {
    clr.addEventListener('click', () => {
        var buttons = clr.parentNode.querySelectorAll('button[type="button"]');
        for (i in buttons) {
            var radio = document.querySelector('input[type="radio"][name="' + buttons[i].name + '"][value="0"]');
            var checked = document.querySelector('input[type="radio"][name="' + buttons[i].name + '"]:checked');
            if (checked)
                checked.checked = false;
            if (radio)
                radio.checked = true;
            buttons[i].className = "btn btn-secondary c0";
        }
    });
});

const invert = document.querySelectorAll('input[name="invert"]');

invert.forEach(inv => {
    inv.addEventListener('click', () => {
        var buttons = inv.parentNode.querySelectorAll('button[type="button"]');
        for (var i in buttons) {
            if (buttons[i].name)
                toggle(buttons[i]);
        }
    });
});

const ttg = document.querySelectorAll('input[name="ttg"]');

ttg.forEach(tt => {
    tt.addEventListener('keypress', (event) => {
        var keyCode = event.keyCode || event.which;
        if (keyCode === 13) {
            event.preventDefault();
            tt.nextElementSibling.click();
        }
    });
});

let action = null;

const button = document.querySelectorAll('button[type="button"]');

button.forEach(btn => {
    btn.addEventListener('mousedown', () => {
        toggle(btn);
        action = "not null";
    });
    btn.addEventListener('mouseup click', (event) => {
        event.preventDefault();
        action = null;
    });
    btn.addEventListener('mouseenter', (event) => {
        if (action)
            toggle(btn);
    });
});

document.addEventListener("mouseup", function (event) {
    action = null;
});


const dismiss = document.getElementById('dismiss');

dismiss.addEventListener('click', (event) => {
    event.preventDefault();
    dismiss.parent.parentNode.style.display = 'none';
});


let theme = localStorage.getItem("theme")

if (theme && theme === 'light') {
    console.log('Light theme')
    document.getElementById("checkbox").checked = true
    document.documentElement.setAttribute('theme', 'light');
    document.getElementsByClassName("nextTheme")[0].innerHTML = "Light Mode";
}

const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');

function changeTheme(e) {
    if (e.target.checked) {
        document.documentElement.setAttribute('theme', 'light');
        document.getElementsByClassName("nextTheme")[0].innerHTML = "Light Mode";
        localStorage.setItem('theme', 'light')
    }
    else {
        document.documentElement.setAttribute('theme', 'dark');
        document.getElementsByClassName("nextTheme")[0].innerHTML = "Dark Mode";
        localStorage.setItem('theme', 'dark')
    }
}

toggleSwitch.addEventListener('change', changeTheme, false);

txt['annen'] = [
    '                                                  ',
    ' ##  #   # #   # ### #   #   #   # ###  ###  ### #',
    '#  # ##  # ##  # #   ##  #   ## ## #   #    #    #',
    '#### # # # # # # ### # # #   # # # ###  ##   ##  #',
    '#  # #  ## #  ## #   #  ##   #   # #      #    #  ',
    '#  # #   # #   # ### #   #   #   # ### ###  ###  #',
    '                                                  '
];
pub.push('annen');

txt['<3'] = [
    '     ',
    '     ',
    '## ##',
    '#####',
    ' ### ',
    '  #  ',
    '     '
];
pub.push('<3');

txt['a'] = [
    '     ',
    '     ',
    ' ##  ',
    '#  # ',
    '#  # ',
    ' ## #',
    '     '
];

txt['b'] = [
    '   ',
    '#  ',
    '#  ',
    '### ',
    '#  #',
    '### ',
    '   '
];

txt['c'] = [
    '   ',
    '   ',
    ' ##',
    '#  ',
    '#  ',
    ' ##',
    '   '
];




txt['o'] = [
    '   ',
    '   ',
    '###',
    '# #',
    '# #',
    '###',
    '   '
];


txt['$'] = [
    '  #  ',
    '#####',
    '# #  ',
    '#####',
    '  # #',
    '#####',
    '  #  '
];


txt['|'] = [
    ' ',
    '#',
    '#',
    '#',
    '#',
    ' ',
];

txt['smile'] = [
    '     ',
    '#   #',
    '     ',
    '#   #',
    ' ### ',
    '     ',
    '     '
];

pub.push('smile');


txt['n'] = [
    '    ',
    '    ',
    ' ## ',
    '#  #',
    '#  #',
    '#  #',
    '    '
];


txt['∞'] = [
    '         ',
    ' ##   ## ',
    '#  # #  #',
    '#   #   #',
    '#  # #  #',
    ' ##   ## ',
    '         '
];


